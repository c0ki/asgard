{% extends app.layouttheme %}

{% block head_css %}
    {{ parent() }}
    {% stylesheets
    'bundles/logtracker/css/view.css'
    filter='cssrewrite' %}
    <link rel="stylesheet" href="{{ asset_url }}"/>
    {% endstylesheets %}
{% endblock %}

{% block content %}
    <section id="logtracker">
        <h2>Log Tracker</h2>
        <h3>
            Chart
            {% if daemon|default %}
                for {{ daemon }} daemon
                {% if type|default %}
                    and {{ type }} type
                {% endif %}
            {% elseif type|default %}
                for {{ type }} type
            {% endif %}
        </h3>
        <div id="chart" data-url="{{ path('log_tracker_data', {'query': query}) }}" data-redirect="{{ path('log_tracker_search') }}"><span data-type="progress"></span></div>
    </section>
{% endblock %}


{% block foot_js %}
    <script>
        document.getElementById('chart').style.height =
                (document.querySelector('main').getBoundingClientRect().height
                + document.querySelector('main').getBoundingClientRect().top
                - document.getElementById('chart').getBoundingClientRect().top
                - window.getComputedStyle(document.querySelector('#main')).marginBottom.slice(0, -2))
                + 'px';
    </script>
    {{ parent() }}
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/serial.js"></script>
    <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
    {% javascripts
    '@LogTrackerBundle/Resources/public/js/chart.js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}


